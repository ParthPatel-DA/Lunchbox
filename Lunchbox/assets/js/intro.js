(function(root,factory){if(typeof exports==='object'){factory(exports);}else if(typeof define==='function'&&define.amd){define(['exports'],factory);}else{factory(root);}}(this,function(exports){var VERSION='0.4.0';function IntroJs(obj){this._targetElement=obj;this._options={nextLabel:'Next &rarr;',prevLabel:'&larr; Back',skipLabel:'Skip',doneLabel:'Done',tooltipPosition:'bottom',exitOnEsc:true,exitOnOverlayClick:true,showStepNumbers:true};}function _introForElement(targetElm){var introItems=[],self=this;if(this._options.steps){var allIntroSteps=[];for(var i=0,stepsLength=this._options.steps.length;i<stepsLength;i++){var currentItem=this._options.steps[i];currentItem.step=i+1;currentItem.element=document.querySelector(currentItem.element);introItems.push(currentItem);}}else{var allIntroSteps=targetElm.querySelectorAll('*[data-intro]');if(allIntroSteps.length<1){return false;}for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];introItems.push({element:currentElement,intro:currentElement.getAttribute('data-intro'),step:parseInt(currentElement.getAttribute('data-step'),10),position:currentElement.getAttribute('data-position')||this._options.tooltipPosition});}}introItems.sort(function(a,b){return a.step-b.step;});self._introItems=introItems;if(_addOverlayLayer.call(self,targetElm)){_nextStep.call(self);var skipButton=targetElm.querySelector('.introjs-skipbutton'),nextStepButton=targetElm.querySelector('.introjs-nextbutton');self._onKeyDown=function(e){if(e.keyCode===27&&self._options.exitOnEsc==true){_exitIntro.call(self,targetElm);}else if(e.keyCode===37){_previousStep.call(self);}else if(e.keyCode===39||e.keyCode===13){_nextStep.call(self);if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}}};self._onResize=function(e){_setHelperLayerPosition.call(self,document.querySelector('.introjs-helperLayer'));};if(window.addEventListener){window.addEventListener('keydown',self._onKeyDown,true);window.addEventListener("resize",self._onResize,true);}else if(document.attachEvent){document.attachEvent('onkeydown',self._onKeyDown);document.attachEvent("onresize",self._onResize);}}return false;}function _goToStep(step){this._currentStep=step-2;if(typeof(this._introItems)!=='undefined'){_nextStep.call(this);}}function _nextStep(){if(typeof(this._currentStep)==='undefined'){this._currentStep=0;}else{++this._currentStep;}if((this._introItems.length)<=this._currentStep){if(typeof(this._introCompleteCallback)==='function'){this._introCompleteCallback.call(this);}_exitIntro.call(this,this._targetElement);return;}_showElement.call(this,this._introItems[this._currentStep]);}function _previousStep(){if(this._currentStep===0){return false;}_showElement.call(this,this._introItems[--this._currentStep]);}function _exitIntro(targetElement){var overlayLayer=targetElement.querySelector('.introjs-overlay');overlayLayer.style.opacity=0;setTimeout(function(){if(overlayLayer.parentNode){overlayLayer.parentNode.removeChild(overlayLayer);}},500);var helperLayer=targetElement.querySelector('.introjs-helperLayer');if(helperLayer){helperLayer.parentNode.removeChild(helperLayer);}var showElement=document.querySelector('.introjs-showElement');if(showElement){showElement.className=showElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'');}var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'');};}if(window.removeEventListener){window.removeEventListener('keydown',this._onKeyDown,true);}else if(document.detachEvent){document.detachEvent('onkeydown',this._onKeyDown);}this._currentStep=undefined;if(this._introExitCallback!=undefined){this._introExitCallback.call(this);}}function _placeTooltip(targetElement,tooltipLayer,arrowLayer){tooltipLayer.style.top=null;tooltipLayer.style.right=null;tooltipLayer.style.bottom=null;tooltipLayer.style.left=null;if(!this._introItems[this._currentStep])return;var currentTooltipPosition=this._introItems[this._currentStep].position;switch(currentTooltipPosition){case'top':tooltipLayer.style.left='15px';tooltipLayer.style.top='-'+(_getOffset(tooltipLayer).height+10)+'px';arrowLayer.className='introjs-arrow bottom';break;case'right':tooltipLayer.style.left=(_getOffset(targetElement).width+20)+'px';arrowLayer.className='introjs-arrow left';break;case'left':tooltipLayer.style.top='15px';tooltipLayer.style.right=(_getOffset(targetElement).width+20)+'px';arrowLayer.className='introjs-arrow right';break;case'bottom':default:tooltipLayer.style.bottom='-'+(_getOffset(tooltipLayer).height+10)+'px';arrowLayer.className='introjs-arrow top';break;}}function _setHelperLayerPosition(helperLayer){if(helperLayer){if(!this._introItems[this._currentStep])return;var elementPosition=_getOffset(this._introItems[this._currentStep].element);helperLayer.setAttribute('style','width: '+(elementPosition.width+10)+'px; '+'height:'+(elementPosition.height+10)+'px; '+'top:'+(elementPosition.top-5)+'px;'+'left: '+(elementPosition.left-5)+'px;');}}function _showElement(targetElement){if(typeof(this._introChangeCallback)!=='undefined'){this._introChangeCallback.call(this,targetElement.element);}var self=this,oldHelperLayer=document.querySelector('.introjs-helperLayer'),elementPosition=_getOffset(targetElement.element);if(oldHelperLayer!=null){var oldHelperNumberLayer=oldHelperLayer.querySelector('.introjs-helperNumberLayer'),oldtooltipLayer=oldHelperLayer.querySelector('.introjs-tooltiptext'),oldArrowLayer=oldHelperLayer.querySelector('.introjs-arrow'),oldtooltipContainer=oldHelperLayer.querySelector('.introjs-tooltip'),skipTooltipButton=oldHelperLayer.querySelector('.introjs-skipbutton'),prevTooltipButton=oldHelperLayer.querySelector('.introjs-prevbutton'),nextTooltipButton=oldHelperLayer.querySelector('.introjs-nextbutton');oldtooltipContainer.style.opacity=0;_setHelperLayerPosition.call(self,oldHelperLayer);var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'');};}var oldShowElement=document.querySelector('.introjs-showElement');oldShowElement.className=oldShowElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'');if(self._lastShowElementTimer){clearTimeout(self._lastShowElementTimer);}self._lastShowElementTimer=setTimeout(function(){if(oldHelperNumberLayer!=null){oldHelperNumberLayer.innerHTML=targetElement.step;}oldtooltipLayer.innerHTML=targetElement.intro;_placeTooltip.call(self,targetElement.element,oldtooltipContainer,oldArrowLayer);oldtooltipContainer.style.opacity=1;},350);}else{var helperLayer=document.createElement('div'),arrowLayer=document.createElement('div'),tooltipLayer=document.createElement('div');helperLayer.className='introjs-helperLayer';_setHelperLayerPosition.call(self,helperLayer);this._targetElement.appendChild(helperLayer);arrowLayer.className='introjs-arrow';tooltipLayer.className='introjs-tooltip';tooltipLayer.innerHTML='<div class="introjs-tooltiptext">'+targetElement.intro+'</div><div class="introjs-tooltipbuttons"></div>';if(this._options.showStepNumbers){var helperNumberLayer=document.createElement('span');helperNumberLayer.className='introjs-helperNumberLayer';helperNumberLayer.innerHTML=targetElement.step;helperLayer.appendChild(helperNumberLayer);}tooltipLayer.appendChild(arrowLayer);helperLayer.appendChild(tooltipLayer);var nextTooltipButton=document.createElement('a');nextTooltipButton.onclick=function(){if(self._introItems.length-1!=self._currentStep){_nextStep.call(self);}};nextTooltipButton.href='javascript:void(0);';nextTooltipButton.innerHTML=this._options.nextLabel;var prevTooltipButton=document.createElement('a');prevTooltipButton.onclick=function(){if(self._currentStep!=0){_previousStep.call(self);}};prevTooltipButton.href='javascript:void(0);';prevTooltipButton.innerHTML=this._options.prevLabel;var skipTooltipButton=document.createElement('a');skipTooltipButton.className='introjs-button introjs-skipbutton';skipTooltipButton.href='javascript:void(0);';skipTooltipButton.innerHTML=this._options.skipLabel;skipTooltipButton.onclick=function(){if(self._introItems.length-1==self._currentStep&&typeof(self._introCompleteCallback)==='function'){self._introCompleteCallback.call(self);}_exitIntro.call(self,self._targetElement);};var tooltipButtonsLayer=tooltipLayer.querySelector('.introjs-tooltipbuttons');tooltipButtonsLayer.appendChild(skipTooltipButton);tooltipButtonsLayer.appendChild(prevTooltipButton);tooltipButtonsLayer.appendChild(nextTooltipButton);_placeTooltip.call(self,targetElement.element,tooltipLayer,arrowLayer);}if(this._currentStep==0){prevTooltipButton.className='introjs-button introjs-prevbutton introjs-disabled';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel;}else if(this._introItems.length-1==this._currentStep){skipTooltipButton.innerHTML=this._options.doneLabel;prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton introjs-disabled';}else{prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel;}nextTooltipButton.focus();targetElement.element.className+=' introjs-showElement';var currentElementPosition=_getPropValue(targetElement.element,'position');if(currentElementPosition!=='absolute'&&currentElementPosition!=='relative'){targetElement.element.className+=' introjs-relativePosition';}var parentElm=targetElement.element.parentNode;while(parentElm!=null){if(parentElm.tagName.toLowerCase()==='body')break;var zIndex=_getPropValue(parentElm,'z-index');if(/[0-9]+/.test(zIndex)){parentElm.className+=' introjs-fixParent';}parentElm=parentElm.parentNode;}if(!_elementInViewport(targetElement.element)){var rect=targetElement.element.getBoundingClientRect(),top=rect.bottom-(rect.bottom-rect.top),bottom=rect.bottom-_getWinSize().height;if(top<0){window.scrollBy(0,top-30);}else{window.scrollBy(0,bottom+100);}}}function _getPropValue(element,propName){var propValue='';if(element.currentStyle){propValue=element.currentStyle[propName];}else if(document.defaultView&&document.defaultView.getComputedStyle){propValue=document.defaultView.getComputedStyle(element,null).getPropertyValue(propName);}if(propValue.toLowerCase){return propValue.toLowerCase();}else{return propValue;}}function _getWinSize(){if(window.innerWidth!=undefined){return{width:window.innerWidth,height:window.innerHeight};}else{var D=document.documentElement;return{width:D.clientWidth,height:D.clientHeight};}}function _elementInViewport(el){var rect=el.getBoundingClientRect();return(rect.top>=0&&rect.left>=0&&(rect.bottom+80)<=window.innerHeight&&rect.right<=window.innerWidth);}function _addOverlayLayer(targetElm){var overlayLayer=document.createElement('div'),styleText='',self=this;overlayLayer.className='introjs-overlay';if(targetElm.tagName.toLowerCase()==='body'){styleText+='top: 0;bottom: 0; left: 0;right: 0;position: fixed;';overlayLayer.setAttribute('style',styleText);}else{var elementPosition=_getOffset(targetElm);if(elementPosition){styleText+='width: '+elementPosition.width+'px; height:'+elementPosition.height+'px; top:'+elementPosition.top+'px;left: '+elementPosition.left+'px;';overlayLayer.setAttribute('style',styleText);}}targetElm.appendChild(overlayLayer);overlayLayer.onclick=function(){if(self._options.exitOnOverlayClick==true){_exitIntro.call(self,targetElm);}};setTimeout(function(){styleText+='opacity: .8;';overlayLayer.setAttribute('style',styleText);},10);return true;}function _getOffset(element){var elementPosition={};elementPosition.width=element.offsetWidth;elementPosition.height=element.offsetHeight;var _x=0;var _y=0;while(element&&!isNaN(element.offsetLeft)&&!isNaN(element.offsetTop)){_x+=element.offsetLeft;_y+=element.offsetTop;element=element.offsetParent;}elementPosition.top=_y;elementPosition.left=_x;return elementPosition;}function _mergeOptions(obj1,obj2){var obj3={};for(var attrname in obj1){obj3[attrname]=obj1[attrname];}for(var attrname in obj2){obj3[attrname]=obj2[attrname];}return obj3;}var introJs=function(targetElm){if(typeof(targetElm)==='object'){return new IntroJs(targetElm);}else if(typeof(targetElm)==='string'){var targetElement=document.querySelector(targetElm);if(targetElement){return new IntroJs(targetElement);}else{throw new Error('There is no element with given selector.');}}else{return new IntroJs(document.body);}};introJs.version=VERSION;introJs.fn=IntroJs.prototype={clone:function(){return new IntroJs(this);},setOption:function(option,value){this._options[option]=value;return this;},setOptions:function(options){this._options=_mergeOptions(this._options,options);return this;},start:function(){_introForElement.call(this,this._targetElement);return this;},goToStep:function(step){_goToStep.call(this,step);return this;},exit:function(){_exitIntro.call(this,this._targetElement);},onchange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introChangeCallback=providedCallback;}else{throw new Error('Provided callback for onchange was not a function.');}return this;},oncomplete:function(providedCallback){if(typeof(providedCallback)==='function'){this._introCompleteCallback=providedCallback;}else{throw new Error('Provided callback for oncomplete was not a function.');}return this;},onexit:function(providedCallback){if(typeof(providedCallback)==='function'){this._introExitCallback=providedCallback;}else{throw new Error('Provided callback for onexit was not a function.');}return this;}};exports.introJs=introJs;return introJs;}));